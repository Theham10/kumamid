<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ë””ìì´ë„ˆ ìƒì„¸ ë³´ê¸°</title>
    <link rel="stylesheet" href="./view.css">
</head>
<body>
    
    <div class="detail-container">
        <div class="designer-header">
            <div class="designer-school-info">
                í•œêµ­ì˜ìƒëŒ€í•™êµ ì˜ìƒë””ìì¸ê³¼<br>ì œ24íšŒ 2023 ì¡¸ì—…ì „
            </div>
            <h2 class="designer-title">Designer</h2>
            <div class="designer-profile-row">
                <div class="profile-img-container">
                    <img id="profileImg" src="" alt="" class="profile-img">
                </div>
                <div class="profile-text-box">
                    <div id="designerName" class="profile-name"></div>
                    <div id="designerInfo" class="profile-info"></div>
                </div>
            </div>
            <hr class="divider">
            <div class="designer-quote">
                BTS, ë´‰ì¤€í˜¸, ì†í¥ë¯¼, ê³½í¬ì§„ ë ˆì¸ ê³ !
            </div>
            <hr class="divider">
        </div>
    </div>
<!-- 
    <div style="max-width: 1140px; margin: 0 auto; padding: 0 1rem 4rem; text-align: left;">
        <h2 style="color: #fff; font-size: 1.5rem; margin: 2rem 0 1rem;">Projects</h2>
        <div style="display: flex; flex-wrap: wrap; gap: 2rem;">
            <a class="project-link" href="https://kumamid.com/Projects/view/425557" target="_blank"
                style="flex: 1 1 550px; text-decoration: none; color: inherit;">
                <div style="overflow: hidden; border-radius: 10px;">
                    <img src="https://lh3.googleusercontent.com/8DvlNOV-i2rMqMgSL8_nuHm4ENT7rSiL3Kdode8UKZkgb4flWv1K_U_lLOIqmmWzh5IUTTvvBwGGeqhHZyghIc65R0lgUUzID42qQEw-86zeEOpW6sg8jA"
                        alt="LocknRoll Poster" style="width: 100%; height: auto; display: block;">
                </div>
                <div style="margin-top: 0.5rem; color: #ccc;"><strong>LocknRoll!</strong> <br>í¬ìŠ¤í„°</div>
            </a>
            <a class="project-link" href="https://kumamid.com/Projects/view/425556" target="_blank"
                style="flex: 1 1 550px; text-decoration: none; color: inherit;">
                <div style="overflow: hidden; border-radius: 10px;">
                    <img src="https://lh3.googleusercontent.com/lfMBmH0OEjKzLh2EZSrHDVVNfw7t-8sgUyPrPjakGzPMB5JtAf10odKWinpJZQc5FpQCJQSg78Xth-wawOQuJgq8cMfcIu6mAt0OjWRiZrfuc7CPkPWJbQ"
                        alt="LocknRoll Video" style="width: 100%; height: auto; display: block;">
                </div>
                <div style="margin-top: 0.5rem; color: #ccc;"><strong>LocknRoll!</strong> <br>ë¹„ë””ì˜¤</div>
            </a>
            <a class="project-link" href="https://kumamid.com/Projects/view/425095" target="_blank"
                style="flex: 1 1 300px; text-decoration: none; color: inherit;">
                <div style="overflow: hidden; border-radius: 10px;">
                    <img src="https://lh3.googleusercontent.com/NjgBlO6hSIEAdaEd8CSNqIQSyVyIGuat9JSCsCK1wMRzNW2aQmIgBkg3zLT6ZnViFtNf5ls97zAYVtulxGH_bnMY6Dl8SR6TlEM7M207U2v4O4L_PC1L8w=w1920-h1080-n"
                        alt="Bass" style="width: 100%; height: auto; display: block;">
                </div>
                <div style="margin-top: 0.5rem; color: #ccc;"><strong>Bass</strong> <br>íŒ€ í”„ë¡œì íŠ¸</div>
            </a>
        </div>
    </div> -->

    <div class="comment-section">
        <h3>ëŒ“ê¸€ <span style="font-size: 1rem; color: #888;">1</span></h3>
        <div class="comment-box">
            <div class="comment-avatar">ğŸ‘¤</div>
            <div class="comment-content">
                <textarea id="commentInput" placeholder="ëŒ“ê¸€ì„ ì…ë ¥í•´ì£¼ì„¸ìš”."></textarea>
                <div class="comment-options">
                    <label><input type="checkbox" /> ë¹„ë°€ê¸€</label>
                    <button onclick="addComment()">ë“±ë¡</button>
                </div>
            </div>
        </div>
        <div class="comment-item">
            <div class="comment-avatar">ğŸ‘¤</div>
            <div class="comment-body">
                <div class="comment-header">
                    <span class="comment-author">ì„¤</span>
                    <span class="comment-time">1ë…„ ì „</span>
                </div>
                <div class="comment-text">
                    ì˜ìƒë“¤ì—ì„œ ë„ˆì˜ ì¬ì¹˜ê°€ ëŠê»´ì§„ë‹¤ ì¬ë°Œê²Œ ì˜ ë´¤ì˜¤ ì´ê±° ë§Œë“œëŠë¼ ì–¼ë§ˆë‚˜ ê³ ìƒí–ˆì„ê¹Œí•˜ëŠ” ìƒê°ë„ ë“¤ì–´ ìˆ˜ê³ í–ˆë‹¤! BTS ë´‰ì¤€í˜¸ ì†í¥ë¯¼ ê³½í¬ì§„ ê°€ìì•„~!~!
                </div>
            </div>
        </div>
    </div>

    <div style="max-width: 960px; margin: 0 auto; padding: 4rem 1rem;">
        <h3 style="color: #fff; font-size: 1.3rem; margin-bottom: 1.5rem;">ë‹¤ë¥¸ ë””ìì´ë„ˆ ë³´ê¸°</h3>
        <div style="display: flex; flex-wrap: nowrap; overflow-x: auto; gap: 2rem;">
            <a href="/Designer/view/425321" style="flex: 0 0 auto; text-align: center; color: #fff;">
                <img src="https://lh3.googleusercontent.com/wJ640HEZP5IAl18qhPcbmO13LGwKByQ0Z4PO223esW8fAh-krFPIm0fhlmNfLy_qjs_V3jX0Gy0zFvKPuDP5QlVYRs2uwCkW0bKNJPyqhjR_G__nbsmz=w600-h600-n"
                    style="width: 150px; border-radius: 10px;" alt="ê³½í¬ì§„">
                <div style="margin-top: 0.5rem;">ê³½í¬ì§„</div>
            </a>
            <a href="/Designer/view/425320" style="flex: 0 0 auto; text-align: center; color: #fff;">
                <img src="https://lh3.googleusercontent.com/NKDBAS9QpX9n9bEhP6hUhrdnJL_doFYtes5vzi3ZXpfVXJ0oERy8bFPLgEyhBh2soRFQ6f-xguFowpjJ8e_IJRWQT7flQw-Y70mU9sJxLjHNIO6E3277aQ=w600-h600-n"
                    style="width: 150px; border-radius: 10px;" alt="ê¹€ë¯¼ì£¼">
                <div style="margin-top: 0.5rem;">ê¹€ë¯¼ì£¼</div>
            </a>
            <a href="/Designer/view/425319" style="flex: 0 0 auto; text-align: center; color: #fff;">
                <img src="https://lh3.googleusercontent.com/ZO-XHWjvHVXA8p7BzjcFhp0Vvl87HaVYZHUtbJ32RwT-9Ke9ARsFQjsU3Eqyt7bCsTCXpkn_S5eU1bdEztzH28KjpjrGpWIAScrJw0DDch3W2skYpVWoqA=w600-h600-n"
                    style="width: 150px; border-radius: 10px;" alt="ê¹€ì‚¬ë‘">
                <div style="margin-top: 0.5rem;">ê¹€ì‚¬ë‘</div>
            </a>
            <a href="./view.html?id=425318" style="flex: 0 0 auto; text-align: center; color: #fff;">
                <img src="https://lh3.googleusercontent.com/jd2kbQm64AV99SMioTUUl4xyuSBdZ4Qin6czG4B-FiiS5LSi0B01OTJW0tt4gH371-8vobFhT9OgZPCqvyoC_zZUM6HHlg9qPRvcy-uVPnwzjv8dynC0FA=w600-h600-n"
                    style="width: 150px; border-radius: 10px;" alt="ê¹€ì€ì„œ">
                <div style="margin-top: 0.5rem;">ê¹€ì€ì„œ</div>
            </a>
        </div>
    </div>

<script src="../script.js"></script>
    <script>
  document.addEventListener("DOMContentLoaded", () => {
    const params = new URLSearchParams(window.location.search);
    const id = params.get('id');
    console.log("id:", id);

    const getImgUrl = window.getImgUrl;
    const getUserAssetUrl = (name, type, filename) => {
      const base = "https://firebasestorage.googleapis.com/v0/b/jvisiondesign-web.firebasestorage.app/o/";
      const fullPath = type
        ? `2023/UsersWorkData/${name}/${type}/${filename}`
        : `2023/UsersWorkData/${name}/${filename}`;  // flat path if type is empty
      return `${base}${encodeURIComponent(fullPath)}?alt=media`;
    };

    const designer = window.designers.find(d => d.name === id);
    console.log("designer:", designer);

    if (designer) {
      const profileImgEl = document.getElementById("profileImg");
      if (profileImgEl) {
        const profileImgUrl = getImgUrl(designer.name);
        console.log("profileImgUrl:", profileImgUrl);
        profileImgEl.src = profileImgUrl;
        profileImgEl.alt = `${designer.name}_í”„ë¡œí•„`;
      }

      document.getElementById("designerName").textContent = designer.name;

      const infoHtml = (designer.info || "")
        .replace(/(https?:\/\/[^\s]+)/g, '<a href="$1" target="_blank" style="color:#66b2ff;">$1</a>')
        .replace(/ì´ë©”ì¼:\s*([^\s]+)/g, 'ì´ë©”ì¼: <a  style="color:white; text-decoration:none">$1</a>');
      document.getElementById("designerInfo").innerHTML = infoHtml;

      if (designer.posterFile) {
        const poster = document.createElement("img");
        poster.src = getUserAssetUrl(designer.name, "PosterSorce", designer.posterFile);
        poster.alt = `${designer.name}_í¬ìŠ¤í„°`;
        poster.style = "width:100%; margin-top:2rem;";
        document.querySelector(".detail-container").appendChild(poster);
      }

      if (designer.videoFile) {
        const video = document.createElement("video");
        video.src = getUserAssetUrl(designer.name, "VideoSorce", designer.videoFile);
        video.controls = true;
        video.style = "width:100%; margin-top:2rem;";
        document.querySelector(".detail-container").appendChild(video);
      }

      // Render specific labeled content from .txt file if profileText exists
      if (designer.profileText) {
        const textUrl = getUserAssetUrl(designer.name, "", designer.profileText);
        fetch(textUrl)
          .then(response => response.ok ? response.text() : "")
          .then(data => {
            const lines = data.split('\n');
            const result = { "í•œë§ˆë””": "", "ì´ë©”ì¼": "", "ì¥ë˜í¬ë§": "" };
            for (let i = 0; i < lines.length; i++) {
              const key = lines[i].trim();
              if (key.includes("í•œë§ˆë””")) result["í•œë§ˆë””"] = lines[i + 1]?.trim() || "";
              if (key.includes("ì´ë©”ì¼")) result["ì´ë©”ì¼"] = lines[i + 1]?.trim() || "";
              if (key.includes("ì¥ë˜í¬ë§")) result["ì¥ë˜í¬ë§"] = lines[i + 1]?.trim() || "";
            }

            // ê°ê°ì˜ ê°’ì„ ë³€ìˆ˜ë¡œ ë¶„ë¦¬
            const comment = result["í•œë§ˆë””"];
            const email = result["ì´ë©”ì¼"];
            const hope = result["ì¥ë˜í¬ë§"];

            console.log("í•œë§ˆë””:", comment);
            console.log("ì´ë©”ì¼:", email);
            console.log("ì¥ë˜í¬ë§:", hope);

            // ê°ê° ê°œë³„ DOM ìš”ì†Œë¡œ í™œìš© ê°€ëŠ¥
            const textDiv = document.createElement("div");
            textDiv.style = "white-space: pre-wrap; margin-top: 2rem; font-size: 1rem; color: #fff;";
            textDiv.innerHTML = `
              <p><strong>í•œë§ˆë””:</strong> <span id="bioMotto">${comment}</span></p>
              <p><strong>ì´ë©”ì¼:</strong> <span id="bioEmail">${email}</span></p>
              <p><strong>ì¥ë˜í¬ë§:</strong> <span id="bioHope">${hope}</span></p>
            `;
            document.querySelector(".detail-container").appendChild(textDiv);
          })
          .catch(err => {
            console.error("í…ìŠ¤íŠ¸ ë¡œë”© ì‹¤íŒ¨:", err);
          });
      }

    } else {
      document.querySelector(".detail-container").innerHTML = "<p>ë””ìì´ë„ˆ ì •ë³´ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.</p>";
    }

    function getComments() {
      const saved = localStorage.getItem(`comments_${id}`);
      return saved ? JSON.parse(saved) : [];
    }

    function addComment() {
      const input = document.getElementById('commentInput');
      const comment = input.value.trim();
      if (!comment) return;

      const comments = getComments();
      comments.push(comment);
      localStorage.setItem(`comments_${id}`, JSON.stringify(comments));
      input.value = '';
      renderComments();
    }

    function renderComments() {
      // Implement comment rendering
    }

    renderComments();
  });
</script>
</body>

</html>